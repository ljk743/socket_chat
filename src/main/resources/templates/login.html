<!DOCTYPE>
<html>
  <head>
    <title>login</title>
    <script src="./js/jquery-1.12.3.min.js"></script>
<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<style type="text/css">
.vertical-center{
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
</style>
  </head>
  <body>
    <div class="container vertical-center">
	<div class="col-md-6 col-md-offset-3">
      <form  action="loginvalidate" method="post">
        <h2 >Login to chatroom</h2>
        <input type="text" name="username" id="inputName" class="form-control" placeholder="username" required autofocus/>
        <input type="password" name="password" id="inputPassword" class="form-control" placeholder="Password" required/>
        <input type="email" name="email" id="inputEmail" class="form-control" placeholder="Email" required/>
        <input type="text" name="code" id="code" class="form-control" placeholder="VerificationCode" required/>
        <button id="getCodeButton" type="button" class="btn btn-primary">Get Verification Code</button><br><br>
        <button class="btn btn-lg btn-primary btn-block" type="submit">login</button>
      </form>

      <button id="redirectButton" class="btn btn-lg btn-primary btn-block">register</button>
      <script>
        // 找到按钮元素
        var redirectButton = document.getElementById('redirectButton');

        // 给按钮添加点击事件监听器
        redirectButton.addEventListener('click', function() {
          // 在点击时，将页面重定向到指定的登录页面
          window.location.href = "http://localhost:8080/reg";
        });

        let isClickAllowed = true;

        $("#getCodeButton").click(function() {
          if (!isClickAllowed) {
            console.log("Please wait before trying again.");
            return;
          }

          isClickAllowed = false;

          // 设置一分钟后重新允许点击
          setTimeout(function() {
            isClickAllowed = true;
          }, 60000); // 60000 毫秒 = 1 分钟

          const username = $("#inputName").val();
          const email = $("#inputEmail").val();

          const url = `/getcode?username=${encodeURIComponent(username)}&email=${encodeURIComponent(email)}`;

          $.get(url, function(data) {
            console.log(data); // 处理接口返回的数据
          }).fail(function(error) {
            console.error('Error:', error);
          });
        });
      </script>
    </div>
    </div>
  </body>
</html>
